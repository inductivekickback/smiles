"""
Fills text field values into the 4j 'Mileage Reimbursement Request' form.

The official PDF is very brittle and its checkboxes don't always render correctly in different
applications or on older macOS machines. To ensure compatibility, the original form's field_names
and widget geometries were extracted and this module now uses them to draw the forms.


Disclaimer of Warranty

This software is provided "as is," without any warranties of any kind, either express or implied,
including but not limited to the implied warranties of merchantability, fitness for a particular
purpose, or non-infringement. The entire risk arising out of the use or performance of the software
remains with you. In no event shall the software provider be liable for any direct, indirect,
incidental, special, consequential, or punitive damages whatsoever arising out of or in connection
with the use or inability to use the software.
"""
from datetime import datetime

import fitz


__version__ = "1.2.0"
__date__ = "Feb '25"


NUM_ROWS_PAGE_1 = 22
NUM_ROWS_PAGE_2 = 34
MAX_ROWS = NUM_ROWS_PAGE_1 + NUM_ROWS_PAGE_2

PARKING_COL_INDEX = 4
MILES_COL_INDEX = 5
ROUND_TRIP_COL_INDEX = 6


USER_INFO = [("Name", "txtEmpName"),
    ("Employee Number", "txtEmpNumber"),
    ("Building/Department", "txtSchool"),
    ("Account Number", "txtInDistAcct")]

FIELD_NAME_FMTS = [
    "txtP{0}Date.{1}", # NOTE: Page indices start at 1 but widget indices start at 0.
    "txtP{0}FromLoc.{1}",
    "txtP{0}ToLoc.{1}",
    "txtP{0}Purpose.{1}",
    "txtP{0}AmtParking.{1}",
    "txtP{0}Miles.{1}",
    "Check Box{0}" # NOTE: Check Box indices start at 1.
]

INPUT_STR_FORMAT = "%m/%d/%Y" # Equivalent to QDate's toString("MM/dd/yyyy")
OUTPUT_STR_FORMAT = "%m/%d/%y"

PAGE_1_WIDGETS = {
    'txtEmpName':
        (135.1490020751953,107.5479736328125,324.14898681640625,125.5479736328125),
    'txtEmpNumber':
        (422.13800048828125,107.41802978515625,548.1380004882812,125.41802978515625),
    'txtInDistAcct':
        (110.11299896240234,127.04998779296875,326.1130065917969,145.04998779296875),
    'txtSchool':
        (421.9049987792969,127.385986328125,547.905029296875,145.385986328125),
    'txtP1Date.0':
        (37.69580078125,177.52899169921875,87.57080078125,191.02899169921875),
    'txtP1FromLoc.0':
        (92.89189910888672,177.82501220703125,185.89199829101562,191.32501220703125),
    'txtP1ToLoc.0':
        (190.39199829101562,177.82501220703125,295.3919982910156,191.32501220703125),
    'txtP1Purpose.0':
        (297.739013671875,177.46600341796875,433.8630065917969,190.96600341796875),
    'txtP1AmtParking.0':
        (437.6130065917969,177.46600341796875,485.6130065917969,190.96600341796875),
    'txtP1Miles.0':
        (490.4880065917969,177.09100341796875,541.1129760742188,190.59100341796875),
    'Check Box1':
        (554.0789794921875,177.2769775390625,570.9450073242188,190.55499267578125),
    'txtP1Date.1':
        (37.69580078125,195.43402099609375,87.5707015991211,208.93402099609375),
    'txtP1FromLoc.1':
        (92.89189910888672,195.07501220703125,185.89199829101562,208.57501220703125),
    'txtP1ToLoc.1':
        (190.39199829101562,195.07501220703125,295.3919982910156,208.57501220703125),
    'txtP1Purpose.1':
        (297.739013671875,194.71600341796875,433.8630065917969,208.21600341796875),
    'txtP1AmtParking.1':
        (437.6130065917969,194.71600341796875,485.6130065917969,208.21600341796875),
    'txtP1Miles.1':
        (490.4880065917969,194.34100341796875,541.1129760742188,207.84100341796875),
    'Check Box2':
        (555.0540161132812,195.38201904296875,570.7630004882812,207.8179931640625),
    'txtP1Date.2':
        (37.69580078125,213.3389892578125,87.57080078125,226.8389892578125),
    'txtP1FromLoc.2':
        (92.89189910888672,212.32501220703125,185.89199829101562,225.82501220703125),
    'txtP1ToLoc.2':
        (190.39199829101562,212.32501220703125,295.3919982910156,225.82501220703125),
    'txtP1Purpose.2':
        (297.739013671875,211.96600341796875,433.8630065917969,225.46600341796875),
    'txtP1AmtParking.2':
        (437.6130065917969,211.96600341796875,485.6130065917969,225.46600341796875),
    'txtP1Miles.2':
        (490.4880065917969,211.59100341796875,541.1129760742188,225.09100341796875),
    'Check Box3':
        (554.4000244140625,212.4000244140625,570.4359741210938,225.16400146484375),
    'txtP1Date.3':
        (37.69580078125,229.93402099609375,87.57080078125,243.43402099609375),
    'txtP1FromLoc.3':
        (92.89189910888672,229.57501220703125,185.89199829101562,243.07501220703125),
    'txtP1ToLoc.3':
        (190.39199829101562,229.57501220703125,295.3919982910156,243.07501220703125),
    'txtP1Purpose.3':
        (297.739013671875,229.21600341796875,433.8630065917969,242.71600341796875),
    'txtP1AmtParking.3':
        (437.6130065917969,229.21600341796875,485.6130065917969,242.71600341796875),
    'txtP1Miles.3':
        (490.4880065917969,228.84100341796875,541.1129760742188,242.34100341796875),
    'Check Box4':
        (554.4000244140625,230.072998046875,570.4359741210938,241.20001220703125),
    'txtP1Date.4':
        (38.350399017333984,246.52899169921875,88.22530364990234,260.02899169921875),
    'txtP1FromLoc.4':
        (92.89189910888672,246.82501220703125,185.89199829101562,260.32501220703125),
    'txtP1ToLoc.4':
        (190.39199829101562,246.82501220703125,295.3919982910156,260.32501220703125),
    'txtP1Purpose.4':
        (297.739013671875,246.46600341796875,433.8630065917969,259.96600341796875),
    'txtP1AmtParking.4':
        (437.6130065917969,246.46600341796875,485.6130065917969,259.96600341796875),
    'txtP1Miles.4':
        (490.4880065917969,246.09100341796875,541.1129760742188,259.59100341796875),
    'Check Box5':
        (554.7269897460938,246.43597412109375,570.1090087890625,259.85400390625),
    'txtP1Date.5':
        (38.350399017333984,264.43402099609375,88.22530364990234,277.93402099609375),
    'txtP1FromLoc.5':
        (92.89189910888672,264.07501220703125,185.89199829101562,277.57501220703125),
    'txtP1ToLoc.5':
        (190.39199829101562,264.07501220703125,295.3919982910156,277.57501220703125),
    'txtP1Purpose.5':
        (297.739013671875,263.71600341796875,433.8630065917969,277.21600341796875),
    'txtP1AmtParking.5':
        (437.6130065917969,263.71600341796875,485.6130065917969,277.21600341796875),
    'txtP1Miles.5':
        (490.4880065917969,263.34100341796875,541.1129760742188,276.84100341796875),
    'Check Box6':
        (555.0540161132812,264.1090087890625,569.781005859375,276.218017578125),
    'txtP1Date.6':
        (38.350399017333984,281.6839904785156,88.22530364990234,295.1839904785156),
    'txtP1FromLoc.6':
        (92.89189910888672,281.32501220703125,185.89199829101562,294.82501220703125),
    'txtP1ToLoc.6':
        (190.39199829101562,281.32501220703125,295.3919982910156,294.82501220703125),
    'txtP1Purpose.6':
        (297.739013671875,280.96600341796875,433.8630065917969,294.46600341796875),
    'txtP1AmtParking.6':
        (437.6130065917969,280.96600341796875,485.6130065917969,294.46600341796875),
    'txtP1Miles.6':
        (490.4880065917969,280.59100341796875,541.1129760742188,294.09100341796875),
    'Check Box7':
        (555.0540161132812,280.79998779296875,569.781005859375,293.8909912109375),
    'txtP1Date.7':
        (38.68119812011719,297.9549865722656,88.55580139160156,311.4549865722656),
    'txtP1FromLoc.7':
        (93.53890228271484,297.927001953125,186.53900146484375,311.427001953125),
    'txtP1ToLoc.7':
        (190.71499633789062,298.2510070800781,295.7149963378906,311.7510070800781),
    'txtP1Purpose.7':
        (297.09100341796875,297.8919982910156,433.21600341796875,311.3919982910156),
    'txtP1AmtParking.7':
        (437.93701171875,297.8919982910156,485.93701171875,311.3919982910156),
    'txtP1Miles.7':
        (491.135009765625,297.5169982910156,541.760009765625,311.0169982910156),
    'Check Box8':
        (555.3809814453125,297.8179931640625,569.781005859375,310.2539978027344),
    'txtP1Date.8':
        (39.01219940185547,315.8680114746094,88.88739776611328,329.3680114746094),
    'txtP1FromLoc.8':
        (93.53890228271484,314.85400390625,186.53900146484375,328.35400390625),
    'txtP1ToLoc.8':
        (190.39199829101562,314.85400390625,295.3919982910156,328.35400390625),
    'txtP1Purpose.8':
        (297.09100341796875,314.4949951171875,433.21600341796875,327.9949951171875),
    'txtP1AmtParking.8':
        (438.260986328125,314.8179931640625,486.260009765625,328.3179931640625),
    'txtP1Miles.8':
        (491.4590148925781,314.7669982910156,542.083984375,328.2669982910156),
    'Check Box9':
        (555.3809814453125,315.8179931640625,569.4539794921875,326.94500732421875),
    'txtP1Date.9':
        (39.34299850463867,332.79400634765625,89.21790313720703,346.29400634765625),
    'txtP1FromLoc.9':
        (93.53890228271484,332.427001953125,186.53900146484375,345.927001953125),
    'txtP1ToLoc.9':
        (190.39199829101562,332.10400390625,295.3919982910156,345.60400390625),
    'txtP1Purpose.9':
        (297.739013671875,332.0679931640625,433.8630065917969,345.5679931640625),
    'txtP1AmtParking.9':
        (437.6130065917969,332.3919982910156,485.6130065917969,345.8919982910156),
    'txtP1Miles.9':
        (491.4590148925781,332.0169982910156,542.083984375,345.5169982910156),
    'Check Box10':
        (555.3809814453125,332.1820068359375,571.0910034179688,344.94500732421875),
    'txtP1Date.10':
        (39.67399978637695,350.0360107421875,89.54850006103516,363.5360107421875),
    'txtP1FromLoc.10':
        (93.53890228271484,350.3240051269531,186.53900146484375,363.8240051269531),
    'txtP1ToLoc.10':
        (190.71499633789062,350.0010070800781,295.7149963378906,363.5010070800781),
    'txtP1Purpose.10':
        (297.739013671875,349.6419982910156,433.8630065917969,363.1419982910156),
    'txtP1AmtParking.10':
        (437.6130065917969,349.6419982910156,485.6130065917969,363.1419982910156),
    'txtP1Miles.10':
        (491.135009765625,349.59100341796875,541.760009765625,363.0899963378906),
    'Check Box11':
        (555.708984375,350.1820068359375,570.7630004882812,362.6180114746094),
    'txtP1Date.11':
        (40.11399841308594,366.4519958496094,89.98889923095703,379.9519958496094),
    'txtP1FromLoc.11':
        (92.69190216064453,367.4020080566406,185.69200134277344,380.9020080566406),
    'txtP1ToLoc.11':
        (190.19200134277344,367.4020080566406,295.1919860839844,380.9020080566406),
    'txtP1Purpose.11':
        (297.53900146484375,367.0429992675781,433.6629943847656,380.5429992675781),
    'txtP1AmtParking.11':
        (437.4129943847656,367.0429992675781,485.4129943847656,380.5429992675781),
    'txtP1Miles.11':
        (490.2879943847656,366.6679992675781,540.9130249023438,380.1679992675781),
    'Check Box12':
        (555.3809814453125,367.20001220703125,571.7449951171875,380.94500732421875),
    'txtP1Date.12':
        (40.76860046386719,385.6659851074219,90.64350128173828,399.1659851074219),
    'txtP1FromLoc.12':
        (92.69190216064453,384.6520080566406,185.69200134277344,398.1520080566406),
    'txtP1ToLoc.12':
        (190.19200134277344,384.6520080566406,295.1919860839844,398.1520080566406),
    'txtP1Purpose.12':
        (297.53900146484375,384.2929992675781,433.6629943847656,397.7929992675781),
    'txtP1AmtParking.12':
        (437.4129943847656,384.2929992675781,485.4129943847656,397.7929992675781),
    'txtP1Miles.12':
        (490.2879943847656,383.9179992675781,540.9130249023438,397.4179992675781),
    'Check Box13':
        (555.0540161132812,384.87200927734375,572.4000244140625,397.635986328125),
    'txtP1Date.13':
        (40.76860046386719,402.260986328125,90.64350128173828,415.760986328125),
    'txtP1FromLoc.13':
        (92.69190216064453,401.9020080566406,185.69200134277344,415.4020080566406),
    'txtP1ToLoc.13':
        (190.19200134277344,401.9020080566406,295.1919860839844,415.4020080566406),
    'txtP1Purpose.13':
        (297.53900146484375,401.5429992675781,433.6629943847656,415.0429992675781),
    'txtP1AmtParking.13':
        (437.4129943847656,401.5429992675781,485.4129943847656,415.0429992675781),
    'txtP1Miles.13':
        (490.2879943847656,401.1679992675781,540.9130249023438,414.6679992675781),
    'Check Box14':
        (556.0360107421875,402.2179870605469,571.7449951171875,415.3089904785156),
    'txtP1Date.14':
        (40.76860046386719,420.1659851074219,90.64350128173828,433.6659851074219),
    'txtP1FromLoc.14':
        (92.69190216064453,419.1520080566406,185.69200134277344,432.6520080566406),
    'txtP1ToLoc.14':
        (190.19200134277344,419.1520080566406,295.1919860839844,432.6520080566406),
    'txtP1Purpose.14':
        (297.53900146484375,418.7929992675781,433.6629943847656,432.2929992675781),
    'txtP1AmtParking.14':
        (437.4129943847656,418.7929992675781,485.4129943847656,432.2929992675781),
    'txtP1Miles.14':
        (490.2879943847656,418.4179992675781,540.9130249023438,431.9179992675781),
    'Check Box15':
        (556.6909790039062,419.8909912109375,571.7449951171875,431.01800537109375),
    'txtP1Date.15':
        (40.76860046386719,437.4159851074219,90.64350128173828,450.9159851074219),
    'txtP1FromLoc.15':
        (92.69190216064453,436.4020080566406,185.69200134277344,449.9020080566406),
    'txtP1ToLoc.15':
        (190.19200134277344,436.4020080566406,295.1919860839844,449.9020080566406),
    'txtP1Purpose.15':
        (297.53900146484375,436.0429992675781,433.6629943847656,449.5429992675781),
    'txtP1AmtParking.15':
        (437.4129943847656,436.0429992675781,485.4129943847656,449.5429992675781),
    'txtP1Miles.15':
        (490.2879943847656,435.6679992675781,540.9130249023438,449.1679992675781),
    'Check Box16':
        (556.0360107421875,436.2539978027344,571.4180297851562,449.01800537109375),
    'txtP1Date.16':
        (40.76860046386719,454.010986328125,90.64350128173828,467.510986328125),
    'txtP1FromLoc.16':
        (92.69190216064453,453.6520080566406,185.69200134277344,467.1520080566406),
    'txtP1ToLoc.16':
        (190.19200134277344,453.6520080566406,295.1919860839844,467.1520080566406),
    'txtP1Purpose.16':
        (297.53900146484375,453.2929992675781,433.6629943847656,466.7929992675781),
    'txtP1AmtParking.16':
        (437.4129943847656,453.2929992675781,485.4129943847656,466.7929992675781),
    'txtP1Miles.16':
        (490.2879943847656,452.9179992675781,540.9130249023438,466.4179992675781),
    'Check Box17':
        (555.708984375,453.6000061035156,571.0910034179688,465.7090148925781),
    'txtP1Date.17':
        (40.11399841308594,470.6059875488281,89.98889923095703,484.1059875488281),
    'txtP1FromLoc.17':
        (92.69190216064453,470.9020080566406,185.69200134277344,484.4020080566406),
    'txtP1ToLoc.17':
        (190.19200134277344,470.9020080566406,295.1919860839844,484.4020080566406),
    'txtP1Purpose.17':
        (297.53900146484375,470.5429992675781,433.6629943847656,484.0429992675781),
    'txtP1AmtParking.17':
        (437.4129943847656,470.5429992675781,485.4129943847656,484.0429992675781),
    'txtP1Miles.17':
        (490.2879943847656,470.1679992675781,540.9130249023438,483.6679992675781),
    'Check Box18':
        (555.708984375,470.6180114746094,571.4180297851562,483.3819885253906),
    'txtP1Date.18':
        (40.121299743652344,488.114990234375,89.99649810791016,501.614990234375),
    'txtP1FromLoc.18':
        (92.0448989868164,488.4110107421875,185.0449981689453,501.9110107421875),
    'txtP1ToLoc.18':
        (189.5449981689453,488.4110107421875,294.54400634765625,501.9110107421875),
    'txtP1Purpose.18':
        (296.8909912109375,488.052001953125,433.0159912109375,501.552001953125),
    'txtP1AmtParking.18':
        (436.7659912109375,488.052001953125,484.7659912109375,501.552001953125),
    'txtP1Miles.18':
        (489.6409912109375,487.677001953125,540.2659912109375,501.177001953125),
    'Check Box19':
        (556.0360107421875,488.6180114746094,571.7449951171875,501.7090148925781),
    'txtP1Date.19':
        (40.262901306152344,506.38800048828125,90.13749694824219,519.8880004882812),
    'txtP1FromLoc.19':
        (92.18589782714844,506.02899169921875,185.18600463867188,519.5289916992188),
    'txtP1ToLoc.19':
        (189.68600463867188,506.02899169921875,294.6860046386719,519.5289916992188),
    'txtP1Purpose.19':
        (297.0329895019531,505.6700134277344,433.1579895019531,519.1700439453125),
    'txtP1AmtParking.19':
        (436.9079895019531,505.6700134277344,484.9079895019531,519.1700439453125),
    'txtP1Miles.19':
        (489.7829895019531,505.2950134277344,540.4080200195312,518.7950439453125),
    'Check Box20':
        (555.3809814453125,506.2909851074219,571.7449951171875,519.3819580078125),
    'txtP1Date.20':
        (40.39720153808594,523.0350341796875,90.27189636230469,536.5350341796875),
    'txtP1FromLoc.20':
        (92.97489929199219,522.676025390625,185.97500610351562,536.176025390625),
    'txtP1ToLoc.20':
        (190.47500610351562,522.676025390625,295.4750061035156,536.176025390625),
    'txtP1Purpose.20':
        (297.8219909667969,522.3170166015625,433.9469909667969,535.8170166015625),
    'txtP1AmtParking.20':
        (437.6969909667969,522.3170166015625,485.6960144042969,535.8170166015625),
    'txtP1Miles.20':
        (490.5710144042969,521.9420166015625,541.1959838867188,535.4420166015625),
    'Check Box21':
        (555.708984375,522.6539916992188,571.7449951171875,535.7449951171875),
    'txtP1Date.21':
        (41.524200439453125,540.0059814453125,91.39900207519531,553.5059814453125),
    'txtP1FromLoc.21':
        (92.79290008544922,539.64697265625,185.79299926757812,553.14697265625),
    'txtP1ToLoc.21':
        (190.29299926757812,539.64697265625,295.2929992675781,553.14697265625),
    'txtP1Purpose.21':
        (297.6400146484375,539.2879638671875,433.7640075683594,552.7879638671875),
    'txtP1AmtParking.21':
        (437.5140075683594,539.2879638671875,485.5140075683594,552.7879638671875),
    'txtP1Miles.21':
        (490.3890075683594,538.9129638671875,541.0139770507812,552.4129638671875),
    'Check Box22':
        (555.708984375,539.6719970703125,572.072021484375,551.781005859375),
    'txtP1TotParking':
        (438.4049987792969,561.5449829101562,486.4049987792969,575.0449829101562),
    'txtP1TotMiles':
        (492.12298583984375,561.9039916992188,543.1229858398438,575.4039916992188),
    'txtP1&2TotParking':
        (439.4150085449219,581.60498046875,487.4150085449219,595.10498046875),
    'txtP1&P2TotMiles':
        (492.4049987792969,581.6669921875,543.405029296875,595.822021484375)
}

PAGE_2_WIDGETS = {
    'txtP2Date.0':
        (35.101200103759766,65.28900146484375,85.2260971069336,78.78900146484375),
    'txtP2FromLoc.0':
        (88.66349792480469,65.03900146484375,181.66299438476562,78.53900146484375),
    'txtP2ToLoc.0':
        (186.16299438476562,65.03900146484375,291.1629943847656,78.53900146484375),
    'txtP2Purpose.0':
        (295.66400146484375,65.28900146484375,431.66400146484375,78.78900146484375),
    'txtP2AmtParking.0':
        (436.22601318359375,65.28900146484375,484.10101318359375,78.78900146484375),
    'txtP2Miles.0':
        (488.85101318359375,65.28900146484375,539.4760131835938,78.78900146484375),
    'Check Box23':
        (554.4000244140625,66.1090087890625,569.4539794921875,79.20001220703125),
    'txtP2Date.1':
        (35.101200103759766,82.53900146484375,85.2260971069336,96.03900146484375),
    'txtP2FromLoc.1':
        (88.66349792480469,82.28900146484375,181.66299438476562,95.78900146484375),
    'txtP2ToLoc.1':
        (186.16299438476562,82.28900146484375,291.1629943847656,95.78900146484375),
    'txtP2Purpose.1':
        (295.66400146484375,82.53900146484375,431.66400146484375,96.03900146484375),
    'txtP2AmtParking.1':
        (436.22601318359375,82.53900146484375,484.10101318359375,96.03900146484375),
    'txtP2Miles.1':
        (488.85101318359375,82.53900146484375,539.4760131835938,96.03900146484375),
    'Check Box24':
        (554.4000244140625,83.12701416015625,569.781005859375,95.8909912109375),
    'txtP2Date.2':
        (35.101200103759766,99.78900146484375,85.2260971069336,113.28900146484375),
    'txtP2FromLoc.2':
        (88.66349792480469,99.53900146484375,181.66299438476562,113.03900146484375),
    'txtP2ToLoc.2':
        (186.16299438476562,99.53900146484375,291.1629943847656,113.03900146484375),
    'txtP2Purpose.2':
        (295.66400146484375,99.78900146484375,431.66400146484375,113.28900146484375),
    'txtP2AmtParking.2':
        (436.22601318359375,99.78900146484375,484.10101318359375,113.28900146484375),
    'txtP2Miles.2':
        (488.85101318359375,99.78900146484375,539.4760131835938,113.28900146484375),
    'Check Box25':
        (554.7269897460938,100.14501953125,570.7630004882812,112.90899658203125),
    'txtP2Date.3':
        (35.101200103759766,117.03900146484375,85.2260971069336,130.53900146484375),
    'txtP2FromLoc.3':
        (88.66349792480469,116.78802490234375,181.66299438476562,130.28802490234375),
    'txtP2ToLoc.3':
        (186.16299438476562,116.78802490234375,291.1629943847656,130.28802490234375),
    'txtP2Purpose.3':
        (295.66400146484375,117.03900146484375,431.66400146484375,130.53900146484375),
    'txtP2AmtParking.3':
        (436.22601318359375,117.03900146484375,484.10101318359375,130.53900146484375),
    'txtP2Miles.3':
        (488.85101318359375,117.03900146484375,539.4760131835938,130.53900146484375),
    'Check Box26':
        (554.7269897460938,117.49102783203125,571.0910034179688,130.58197021484375),
    'txtP2Date.4':
        (35.101200103759766,134.28900146484375,85.2260971069336,147.78900146484375),
    'txtP2FromLoc.4':
        (88.66349792480469,134.03802490234375,181.66299438476562,147.53802490234375),
    'txtP2ToLoc.4':
        (186.16299438476562,134.03802490234375,291.1629943847656,147.53802490234375),
    'txtP2Purpose.4':
        (295.66400146484375,134.28900146484375,431.66400146484375,147.78900146484375),
    'txtP2AmtParking.4':
        (436.22601318359375,134.28900146484375,484.10101318359375,147.78900146484375),
    'txtP2Miles.4':
        (488.85101318359375,134.28900146484375,539.4760131835938,147.78900146484375),
    'Check Box27':
        (554.7269897460938,134.83599853515625,571.4180297851562,147.5999755859375),
    'txtP2Date.5':
        (35.101200103759766,151.53900146484375,85.2260971069336,165.03900146484375),
    'txtP2FromLoc.5':
        (88.66349792480469,151.28802490234375,181.66299438476562,164.78802490234375),
    'txtP2ToLoc.5':
        (186.16299438476562,151.28802490234375,291.1629943847656,164.78802490234375),
    'txtP2Purpose.5':
        (295.66400146484375,151.53900146484375,431.66400146484375,165.03900146484375),
    'txtP2AmtParking.5':
        (436.22601318359375,151.53900146484375,484.10101318359375,165.03900146484375),
    'txtP2Miles.5':
        (488.85101318359375,151.53900146484375,539.4760131835938,165.03900146484375),
    'Check Box28':
        (555.0540161132812,151.85400390625,571.7449951171875,163.9639892578125),
    'txtP2Date.6':
        (35.101200103759766,168.78900146484375,85.2260971069336,182.28900146484375),
    'txtP2FromLoc.6':
        (88.66349792480469,168.53802490234375,181.66299438476562,182.03802490234375),
    'txtP2ToLoc.6':
        (186.16299438476562,168.53802490234375,291.1629943847656,182.03802490234375),
    'txtP2Purpose.6':
        (295.66400146484375,168.78900146484375,431.66400146484375,182.28900146484375),
    'txtP2AmtParking.6':
        (436.22601318359375,168.78900146484375,484.10101318359375,182.28900146484375),
    'txtP2Miles.6':
        (488.85101318359375,168.78900146484375,539.4760131835938,182.28900146484375),
    'Check Box29':
        (555.3809814453125,168.87298583984375,572.072021484375,180.98199462890625),
    'txtP2Date.7':
        (35.101200103759766,186.03900146484375,85.2260971069336,199.53900146484375),
    'txtP2FromLoc.7':
        (88.66349792480469,185.78802490234375,181.66299438476562,199.28802490234375),
    'txtP2ToLoc.7':
        (186.16299438476562,185.78802490234375,291.1629943847656,199.28802490234375),
    'txtP2Purpose.7':
        (295.66400146484375,186.03900146484375,431.66400146484375,199.53900146484375),
    'txtP2AmtParking.7':
        (436.22601318359375,186.03900146484375,484.10101318359375,199.53900146484375),
    'txtP2Miles.7':
        (488.85101318359375,186.03900146484375,539.4760131835938,199.53900146484375),
    'Check Box30':
        (555.0540161132812,186.87298583984375,572.072021484375,199.30902099609375),
    'txtP2Date.8':
        (35.101200103759766,203.28900146484375,85.2260971069336,216.78900146484375),
    'txtP2FromLoc.8':
        (88.66349792480469,203.03802490234375,181.66299438476562,216.53802490234375),
    'txtP2ToLoc.8':
        (186.16299438476562,203.03802490234375,291.1629943847656,216.53802490234375),
    'txtP2Purpose.8':
        (295.66400146484375,203.28900146484375,431.66400146484375,216.78900146484375),
    'txtP2AmtParking.8':
        (436.22601318359375,203.28900146484375,484.10101318359375,216.78900146484375),
    'txtP2Miles.8':
        (488.85101318359375,203.28900146484375,539.4760131835938,216.78900146484375),
    'Check Box31':
        (554.4000244140625,203.56402587890625,572.072021484375,217.30902099609375),
    'txtP2Date.9':
        (35.101200103759766,220.53900146484375,85.2260971069336,234.03900146484375),
    'txtP2FromLoc.9':
        (88.66349792480469,220.28802490234375,181.66299438476562,233.78802490234375),
    'txtP2ToLoc.9':
        (186.16299438476562,220.28802490234375,291.1629943847656,233.78802490234375),
    'txtP2Purpose.9':
        (295.66400146484375,220.53900146484375,431.66400146484375,234.03900146484375),
    'txtP2AmtParking.9':
        (436.22601318359375,220.53900146484375,484.10101318359375,234.03900146484375),
    'txtP2Miles.9':
        (488.85101318359375,220.53900146484375,539.4760131835938,234.03900146484375),
    'Check Box32':
        (554.072021484375,221.56298828125,572.072021484375,234.3270263671875),
    'txtP2Date.10':
        (35.101200103759766,237.78900146484375,85.2260971069336,251.28900146484375),
    'txtP2FromLoc.10':
        (88.66349792480469,237.53802490234375,181.66299438476562,251.03802490234375),
    'txtP2ToLoc.10':
        (186.16299438476562,237.53802490234375,291.1629943847656,251.03802490234375),
    'txtP2Purpose.10':
        (295.66400146484375,237.78900146484375,431.66400146484375,251.28900146484375),
    'txtP2AmtParking.10':
        (436.22601318359375,237.78900146484375,484.10101318359375,251.28900146484375),
    'txtP2Miles.10':
        (488.85101318359375,237.78900146484375,539.4760131835938,251.28900146484375),
    'Check Box33':
        (553.7449951171875,238.58197021484375,572.072021484375,251.01800537109375),
    'txtP2Date.11':
        (35.101200103759766,255.03900146484375,85.2260971069336,268.53900146484375),
    'txtP2FromLoc.11':
        (88.66349792480469,254.78802490234375,181.66299438476562,268.28802490234375),
    'txtP2ToLoc.11':
        (186.16299438476562,254.78802490234375,291.1629943847656,268.28802490234375),
    'txtP2Purpose.11':
        (295.66400146484375,255.03900146484375,431.66400146484375,268.53900146484375),
    'txtP2AmtParking.11':
        (436.22601318359375,255.03900146484375,484.10101318359375,268.53900146484375),
    'txtP2Miles.11':
        (488.85101318359375,255.03900146484375,539.4760131835938,268.53900146484375),
    'Check Box34':
        (553.7449951171875,255.27301025390625,572.072021484375,267.38201904296875),
    'txtP2Date.12':
        (35.101200103759766,272.28900146484375,85.2260971069336,285.78900146484375),
    'txtP2FromLoc.12':
        (88.66349792480469,272.03802490234375,181.66299438476562,285.5379943847656),
    'txtP2ToLoc.12':
        (186.16299438476562,272.03802490234375,291.1629943847656,285.5379943847656),
    'txtP2Purpose.12':
        (295.66400146484375,272.28900146484375,431.66400146484375,285.78900146484375),
    'txtP2AmtParking.12':
        (436.22601318359375,272.28900146484375,484.10101318359375,285.78900146484375),
    'txtP2Miles.12':
        (488.85101318359375,272.28900146484375,539.4760131835938,285.78900146484375),
    'Check Box35':
        (553.4180297851562,272.61798095703125,570.7630004882812,284.3999938964844),
    'txtP2Date.13':
        (35.101200103759766,289.53900146484375,85.2260971069336,303.03900146484375),
    'txtP2FromLoc.13':
        (88.66349792480469,289.2879943847656,181.66299438476562,302.7879943847656),
    'txtP2ToLoc.13':
        (186.16299438476562,289.2879943847656,291.1629943847656,302.7879943847656),
    'txtP2Purpose.13':
        (295.66400146484375,289.53900146484375,431.66400146484375,303.03900146484375),
    'txtP2AmtParking.13':
        (436.22601318359375,289.53900146484375,484.10101318359375,303.03900146484375),
    'txtP2Miles.13':
        (488.85101318359375,289.53900146484375,539.4760131835938,303.03900146484375),
    'Check Box36':
        (553.7449951171875,289.9630126953125,571.7449951171875,303.3819885253906),
    'txtP2Date.14':
        (35.101200103759766,306.78900146484375,85.2260971069336,320.28900146484375),
    'txtP2FromLoc.14':
        (88.66349792480469,306.5379943847656,181.66299438476562,320.0379943847656),
    'txtP2ToLoc.14':
        (186.16299438476562,306.5379943847656,291.1629943847656,320.0379943847656),
    'txtP2Purpose.14':
        (295.66400146484375,306.78900146484375,431.66400146484375,320.28900146484375),
    'txtP2AmtParking.14':
        (436.22601318359375,306.78900146484375,484.10101318359375,320.28900146484375),
    'txtP2Miles.14':
        (488.85101318359375,306.78900146484375,539.4760131835938,320.28900146484375),
    'Check Box37':
        (553.4180297851562,307.635986328125,572.072021484375,320.072998046875),
    'txtP2Date.15':
        (35.101200103759766,324.03900146484375,85.2260971069336,337.53900146484375),
    'txtP2FromLoc.15':
        (88.66349792480469,323.7879943847656,181.66299438476562,337.2879943847656),
    'txtP2ToLoc.15':
        (186.16299438476562,323.7879943847656,291.1629943847656,337.2879943847656),
    'txtP2Purpose.15':
        (295.66400146484375,324.03900146484375,431.66400146484375,337.53900146484375),
    'txtP2AmtParking.15':
        (436.22601318359375,324.03900146484375,484.10101318359375,337.53900146484375),
    'txtP2Miles.15':
        (488.85101318359375,324.03900146484375,539.4760131835938,337.53900146484375),
    'Check Box38':
        (553.4180297851562,324.3269958496094,571.4180297851562,338.3999938964844),
    'txtP2Date.16':
        (35.101200103759766,341.28900146484375,85.2260971069336,354.78900146484375),
    'txtP2FromLoc.16':
        (88.66349792480469,341.0379943847656,181.66299438476562,354.5379943847656),
    'txtP2ToLoc.16':
        (186.16299438476562,341.0379943847656,291.1629943847656,354.5379943847656),
    'txtP2Purpose.16':
        (295.66400146484375,341.28900146484375,431.66400146484375,354.78900146484375),
    'txtP2AmtParking.16':
        (436.22601318359375,341.28900146484375,484.10101318359375,354.78900146484375),
    'txtP2Miles.16':
        (488.85101318359375,341.28900146484375,539.4760131835938,354.78900146484375),
    'Check Box39':
        (553.0910034179688,342.0,571.4180297851562,355.09100341796875),
    'txtP2Date.17':
        (35.101200103759766,358.53900146484375,85.2260971069336,372.03900146484375),
    'txtP2FromLoc.17':
        (88.66349792480469,358.2879943847656,181.66299438476562,371.7879943847656),
    'txtP2ToLoc.17':
        (186.16299438476562,358.2879943847656,291.1629943847656,371.7879943847656),
    'txtP2Purpose.17':
        (295.66400146484375,358.53900146484375,431.66400146484375,372.03900146484375),
    'txtP2AmtParking.17':
        (436.22601318359375,358.53900146484375,484.10101318359375,372.03900146484375),
    'txtP2Miles.17':
        (488.85101318359375,358.53900146484375,539.4760131835938,372.03900146484375),
    'Check Box40':
        (553.0910034179688,359.3450012207031,571.4180297851562,372.4360046386719),
    'txtP2Date.18':
        (35.101200103759766,375.78900146484375,85.2260971069336,389.28900146484375),
    'txtP2FromLoc.18':
        (88.66349792480469,375.5379943847656,181.66299438476562,389.0379943847656),
    'txtP2ToLoc.18':
        (186.16299438476562,375.5379943847656,291.1629943847656,389.0379943847656),
    'txtP2Purpose.18':
        (295.66400146484375,375.78900146484375,431.66400146484375,389.28900146484375),
    'txtP2AmtParking.18':
        (436.22601318359375,375.78900146484375,484.10101318359375,389.28900146484375),
    'txtP2Miles.18':
        (488.85101318359375,375.78900146484375,539.4760131835938,389.28900146484375),
    'Check Box41':
        (553.0910034179688,376.3630065917969,570.7630004882812,388.79998779296875),
    'txtP2Date.19':
        (35.101200103759766,393.03900146484375,85.2260971069336,406.53900146484375),
    'txtP2FromLoc.19':
        (88.66349792480469,392.7879943847656,181.66299438476562,406.2879943847656),
    'txtP2ToLoc.19':
        (186.16299438476562,392.7879943847656,291.1629943847656,406.2879943847656),
    'txtP2Purpose.19':
        (295.66400146484375,393.03900146484375,431.66400146484375,406.53900146484375),
    'txtP2AmtParking.19':
        (436.22601318359375,393.03900146484375,484.10101318359375,406.53900146484375),
    'txtP2Miles.19':
        (488.85101318359375,393.03900146484375,539.4760131835938,406.53900146484375),
    'Check Box42':
        (553.0910034179688,393.3819885253906,571.4180297851562,406.79998779296875),
    'txtP2Date.20':
        (35.101200103759766,410.28900146484375,85.2260971069336,423.78900146484375),
    'txtP2FromLoc.20':
        (88.66349792480469,410.0379943847656,181.66299438476562,423.5379943847656),
    'txtP2ToLoc.20':
        (186.16299438476562,410.0379943847656,291.1629943847656,423.5379943847656),
    'txtP2Purpose.20':
        (295.66400146484375,410.28900146484375,431.66400146484375,423.78900146484375),
    'txtP2AmtParking.20':
        (436.22601318359375,410.28900146484375,484.10101318359375,423.78900146484375),
    'txtP2Miles.20':
        (488.85101318359375,410.28900146484375,539.4760131835938,423.78900146484375),
    'Check Box43':
        (553.4180297851562,410.72698974609375,571.7449951171875,423.8179931640625),
    'txtP2Date.21':
        (35.101200103759766,427.53900146484375,85.2260971069336,441.03900146484375),
    'txtP2FromLoc.21':
        (88.66349792480469,427.2879943847656,181.66299438476562,440.7879943847656),
    'txtP2ToLoc.21':
        (186.16299438476562,427.2879943847656,291.1629943847656,440.7879943847656),
    'txtP2Purpose.21':
        (295.66400146484375,427.53900146484375,431.66400146484375,441.03900146484375),
    'txtP2AmtParking.21':
        (436.22601318359375,427.53900146484375,484.10101318359375,441.03900146484375),
    'txtP2Miles.21':
        (488.85101318359375,427.53900146484375,539.4760131835938,441.03900146484375),
    'Check Box44':
        (554.072021484375,428.3999938964844,571.7449951171875,441.1629943847656),
    'txtP2Date.22':
        (35.101200103759766,444.78900146484375,85.2260971069336,458.28900146484375),
    'txtP2FromLoc.22':
        (88.66349792480469,444.5379943847656,181.66299438476562,458.0379943847656),
    'txtP2ToLoc.22':
        (186.16299438476562,444.5379943847656,291.1629943847656,458.0379943847656),
    'txtP2Purpose.22':
        (295.66400146484375,444.78900146484375,431.66400146484375,458.28900146484375),
    'txtP2AmtParking.22':
        (436.22601318359375,444.78900146484375,484.10101318359375,458.28900146484375),
    'txtP2Miles.22':
        (488.85101318359375,444.78900146484375,539.4760131835938,458.28900146484375),
    'Check Box45':
        (554.4000244140625,445.7449951171875,572.4000244140625,459.1629943847656),
    'txtP2Date.23':
        (35.101200103759766,462.03900146484375,85.2260971069336,475.53900146484375),
    'txtP2FromLoc.23':
        (88.66349792480469,461.7879943847656,181.66299438476562,475.2879943847656),
    'txtP2ToLoc.23':
        (186.16299438476562,461.7879943847656,291.1629943847656,475.2879943847656),
    'txtP2Purpose.23':
        (295.66400146484375,462.03900146484375,431.66400146484375,475.53900146484375),
    'txtP2AmtParking.23':
        (436.22601318359375,462.03900146484375,484.10101318359375,475.53900146484375),
    'txtP2Miles.23':
        (488.85101318359375,462.03900146484375,539.4760131835938,475.53900146484375),
    'Check Box46':
        (554.4000244140625,462.76300048828125,572.072021484375,475.85400390625),
    'txtP2Date.24':
        (35.101200103759766,479.2879943847656,85.2260971069336,492.7879943847656),
    'txtP2FromLoc.24':
        (88.66349792480469,479.0379943847656,181.66299438476562,492.5379943847656),
    'txtP2ToLoc.24':
        (186.16299438476562,479.0379943847656,291.1629943847656,492.5379943847656),
    'txtP2Purpose.24':
        (295.66400146484375,479.2879943847656,431.66400146484375,492.7879943847656),
    'txtP2AmtParking.24':
        (436.22601318359375,479.2879943847656,484.10101318359375,492.7879943847656),
    'txtP2Miles.24':
        (488.85101318359375,479.2879943847656,539.4760131835938,492.7879943847656),
    'Check Box47':
        (554.4000244140625,479.7820129394531,572.4000244140625,492.2179870605469),
    'txtP2Date.25':
        (35.101200103759766,496.5379943847656,85.2260971069336,510.0379943847656),
    'txtP2FromLoc.25':
        (88.66349792480469,496.2879943847656,181.66299438476562,509.7879943847656),
    'txtP2ToLoc.25':
        (186.16299438476562,496.2879943847656,291.1629943847656,509.7879943847656),
    'txtP2Purpose.25':
        (295.66400146484375,496.5379943847656,431.66400146484375,510.0379943847656),
    'txtP2AmtParking.25':
        (436.22601318359375,496.5379943847656,484.10101318359375,510.0379943847656),
    'txtP2Miles.25':
        (488.85101318359375,496.5379943847656,539.4760131835938,510.0379943847656),
    'Check Box48':
        (554.7269897460938,497.4540100097656,572.7269897460938,509.8909912109375),
    'txtP2Date.26':
        (35.101200103759766,513.7879638671875,85.2260971069336,527.2879638671875),
    'txtP2FromLoc.26':
        (88.66349792480469,513.5379638671875,181.66299438476562,527.0379638671875),
    'txtP2ToLoc.26':
        (186.16299438476562,513.5379638671875,291.1629943847656,527.0379638671875),
    'txtP2Purpose.26':
        (295.66400146484375,513.7879638671875,431.66400146484375,527.2879638671875),
    'txtP2AmtParking.26':
        (436.22601318359375,513.7879638671875,484.10101318359375,527.2879638671875),
    'txtP2Miles.26':
        (488.85101318359375,513.7879638671875,539.4760131835938,527.2879638671875),
    'Check Box49':
        (555.3809814453125,514.7999877929688,572.072021484375,527.56298828125),
    'txtP2Date.27':
        (35.101200103759766,531.0379638671875,85.2260971069336,544.5379638671875),
    'txtP2FromLoc.27':
        (88.66349792480469,530.7879638671875,181.66299438476562,544.2879638671875),
    'txtP2ToLoc.27':
        (186.16299438476562,530.7879638671875,291.1629943847656,544.2879638671875),
    'txtP2Purpose.27':
        (295.66400146484375,531.0379638671875,431.66400146484375,544.5379638671875),
    'txtP2AmtParking.27':
        (436.22601318359375,531.0379638671875,484.10101318359375,544.5379638671875),
    'txtP2Miles.27':
        (488.85101318359375,531.0379638671875,539.4760131835938,544.5379638671875),
    'Check Box50':
        (555.0540161132812,531.8179931640625,572.4000244140625,544.2540283203125),
    'txtP2Date.28':
        (35.101200103759766,548.2879638671875,85.2260971069336,561.7879638671875),
    'txtP2FromLoc.28':
        (88.66349792480469,548.0379638671875,181.66299438476562,561.5379638671875),
    'txtP2ToLoc.28':
        (186.16299438476562,548.0379638671875,291.1629943847656,561.5379638671875),
    'txtP2Purpose.28':
        (295.66400146484375,548.2879638671875,431.66400146484375,561.7879638671875),
    'txtP2AmtParking.28':
        (436.22601318359375,548.2879638671875,484.10101318359375,561.7879638671875),
    'txtP2Miles.28':
        (488.85101318359375,548.2879638671875,539.4760131835938,561.7879638671875),
    'Check Box51':
        (555.0540161132812,549.490966796875,572.7269897460938,561.927001953125),
    'txtP2Date.29':
        (35.101200103759766,565.5379638671875,85.2260971069336,579.0379638671875),
    'txtP2FromLoc.29':
        (88.66349792480469,565.2879638671875,181.66299438476562,578.7879638671875),
    'txtP2ToLoc.29':
        (186.16299438476562,565.2879638671875,291.1629943847656,578.7879638671875),
    'txtP2Purpose.29':
        (295.66400146484375,565.5379638671875,431.66400146484375,579.0379638671875),
    'txtP2AmtParking.29':
        (436.22601318359375,565.5379638671875,484.10101318359375,579.0379638671875),
    'txtP2Miles.29':
        (488.85101318359375,565.5379638671875,539.4760131835938,579.0379638671875),
    'Check Box52':
        (555.0540161132812,567.1629638671875,573.3809814453125,579.27197265625),
    'txtP2Date.30':
        (35.101200103759766,582.7879638671875,85.2260971069336,596.2879638671875),
    'txtP2FromLoc.30':
        (88.66349792480469,582.5379638671875,181.66299438476562,596.0379638671875),
    'txtP2ToLoc.30':
        (186.16299438476562,582.5379638671875,291.1629943847656,596.0379638671875),
    'txtP2Purpose.30':
        (295.66400146484375,582.7879638671875,431.66400146484375,596.2879638671875),
    'txtP2AmtParking.30':
        (436.22601318359375,582.7879638671875,484.10101318359375,596.2879638671875),
    'txtP2Miles.30':
        (488.85101318359375,582.7879638671875,539.4760131835938,596.2879638671875),
    'Check Box53':
        (555.708984375,583.2000122070312,573.3809814453125,595.3090209960938),
    'txtP2Date.31':
        (35.101200103759766,600.0379638671875,85.2260971069336,613.5379638671875),
    'txtP2FromLoc.31':
        (88.66349792480469,599.7879638671875,181.66299438476562,613.2879638671875),
    'txtP2ToLoc.31':
        (186.16299438476562,599.7879638671875,291.1629943847656,613.2879638671875),
    'txtP2Purpose.31':
        (295.66400146484375,600.0379638671875,431.66400146484375,613.5379638671875),
    'txtP2AmtParking.31':
        (436.22601318359375,600.0379638671875,484.10101318359375,613.5379638671875),
    'txtP2Miles.31':
        (488.85101318359375,600.0379638671875,539.4760131835938,613.5379638671875),
    'Check Box54':
        (555.3809814453125,601.2000122070312,573.708984375,612.6539916992188),
    'txtP2Date.32':
        (35.101200103759766,617.2879638671875,85.2260971069336,630.7879638671875),
    'txtP2FromLoc.32':
        (88.66349792480469,617.0379638671875,181.66299438476562,630.5379638671875),
    'txtP2ToLoc.32':
        (186.16299438476562,617.0379638671875,291.1629943847656,630.5379638671875),
    'txtP2Purpose.32':
        (295.66400146484375,617.2879638671875,431.66400146484375,630.7879638671875),
    'txtP2AmtParking.32':
        (436.22601318359375,617.2879638671875,484.10101318359375,630.7879638671875),
    'txtP2Miles.32':
        (488.85101318359375,617.2879638671875,539.4760131835938,630.7879638671875),
    'Check Box55':
        (554.4000244140625,617.56298828125,574.0360107421875,630.9810180664062),
    'txtP2Date.33':
        (35.101200103759766,634.5379638671875,85.2260971069336,648.0379638671875),
    'txtP2FromLoc.33':
        (88.66349792480469,634.2879638671875,181.66299438476562,647.7879638671875),
    'txtP2ToLoc.33':
        (186.16299438476562,634.2879638671875,291.1629943847656,647.7879638671875),
    'txtP2Purpose.33':
        (295.66400146484375,634.5379638671875,431.66400146484375,648.0379638671875),
    'txtP2AmtParking.33':
        (436.22601318359375,634.5379638671875,484.10101318359375,648.0379638671875),
    'txtP2Miles.33':
        (488.85101318359375,634.5379638671875,539.4760131835938,648.0379638671875),
    'Check Box56':
        (554.7269897460938,635.2359619140625,575.6719970703125,648.3270263671875),
    'txtP2TotParking':
        (436.16400146484375,651.9140014648438,484.16400146484375,665.4140014648438),
    'txtP2TotMiles':
        (489.16400146484375,651.9140014648438,540.1640014648438,665.4140014648438)
}


def _update_widget(page, field_name, widget_rect, value):
    alignment = fitz.TEXT_ALIGN_LEFT
    try:
        if 'Parking' in field_name:
            # Don't clutter the parking col with zeroes.
            alignment = fitz.TEXT_ALIGN_CENTER
            if value:
                value = f"{value:0.2f}"
            else:
                value = ''
        elif 'Miles' in field_name:
            alignment = fitz.TEXT_ALIGN_CENTER
            value = f"{value:0.1f}"
        elif 'Date' in field_name:
            alignment = fitz.TEXT_ALIGN_CENTER
            value = datetime.strptime(value, INPUT_STR_FORMAT).strftime(OUTPUT_STR_FORMAT)
        elif 'Check' in field_name:
            alignment = fitz.TEXT_ALIGN_CENTER
            if value == '1':
                value = 'X'
            else:
                value = ''
        else:
            # Add a leading space because TEXT_ALIGN_LEFT is very aggressive.
            value = f" {value}"
    except ValueError:
        pass

    # Redraw the widget's outline (since we removed all of the actual widgets).
    page.draw_rect(widget_rect, color=(0, 0, 0), fill=(1, 1, 1), overlay=True)
    if value:
        page.insert_textbox(widget_rect, value, fontsize=9, align=alignment)


def _parse_float(value):
    try:
        return float(value)
    except ValueError:
        return 0


def _write_pdf(form_path, additional_form_path, save_path, form_data):
    pdf = fitz.open(form_path)
    page = pdf.load_page(0)
    page.clean_contents()
    for key, widget_rect in PAGE_1_WIDGETS.items():
        form_value = form_data.get(key, '')
        _update_widget(page, key, widget_rect, form_value)

    if additional_form_path:
        add_pdf = fitz.open(additional_form_path)
        pdf.insert_pdf(add_pdf)
        add_pdf.close()
        page = pdf.load_page(1)
        page.clean_contents()
        for key, widget_rect in PAGE_2_WIDGETS.items():
            form_value = form_data.get(key, '')
            _update_widget(page, key, widget_rect, form_value)

    pdf.save(save_path)
    pdf.close()


def fill_form(form_path, additional_form_path, save_path, data):
    """Compute totals while creating a dict for looking up values using the PDF's field_names"""
    user_info = data['USER_INFO']
    table = data['TABLE']

    page_parking_totals = [0]
    page_miles_totals = [0]

    values = {}

    for setting, field_name in USER_INFO:
        values[field_name] = user_info[setting]

    page_len = len(table) if len(table) < NUM_ROWS_PAGE_1 else NUM_ROWS_PAGE_1
    table_row = 0
    row = 0
    data_has_rt_checkbox = len(table[table_row]) > ROUND_TRIP_COL_INDEX
    while table_row < page_len:
        for j in range(0, PARKING_COL_INDEX):
            field_name = FIELD_NAME_FMTS[j].format(1, row)
            values[field_name] = table[table_row][j]

        round_trip = False
        if data_has_rt_checkbox:
            field_name = FIELD_NAME_FMTS[ROUND_TRIP_COL_INDEX].format(table_row + 1)
            values[field_name] = table[table_row][ROUND_TRIP_COL_INDEX]
            round_trip = values[field_name] != '0'

        field_name = FIELD_NAME_FMTS[PARKING_COL_INDEX].format(1, row)
        value = _parse_float(table[table_row][PARKING_COL_INDEX])
        values[field_name] = value
        page_parking_totals[0] += value

        field_name = FIELD_NAME_FMTS[MILES_COL_INDEX].format(1, row)
        value = _parse_float(table[table_row][MILES_COL_INDEX])
        values[field_name] = value
        page_miles_totals[0] += value
        if round_trip:
            page_miles_totals[0] += value

        row += 1
        table_row += 1

    if len(table) > NUM_ROWS_PAGE_1:
        page_parking_totals.append(0)
        page_miles_totals.append(0)
        row = 0
        while table_row < len(table):
            for j in range(0, PARKING_COL_INDEX):
                field_name = FIELD_NAME_FMTS[j].format(2, row)
                values[field_name] = table[table_row][j]

            round_trip = False
            if data_has_rt_checkbox:
                field_name = FIELD_NAME_FMTS[ROUND_TRIP_COL_INDEX].format(table_row + 1)
                values[field_name] = table[table_row][ROUND_TRIP_COL_INDEX]
                round_trip = values[field_name] != '0'

            field_name = FIELD_NAME_FMTS[PARKING_COL_INDEX].format(2, row)
            value = _parse_float(table[table_row][PARKING_COL_INDEX])
            values[field_name] = value
            page_parking_totals[1] += value

            field_name = FIELD_NAME_FMTS[MILES_COL_INDEX].format(2, row)
            value = _parse_float(table[table_row][MILES_COL_INDEX])
            values[field_name] = value
            page_miles_totals[1] += value
            if round_trip:
                page_miles_totals[1] += value

            row += 1
            table_row += 1

    for i in range(0, len(page_parking_totals)):
        values[f"txtP{i+1}TotParking"] = page_parking_totals[i]
        values[f"txtP{i+1}TotMiles"] = page_miles_totals[i]

    values["txtP1&2TotParking"] = sum(page_parking_totals)
    values["txtP1&P2TotMiles"] = sum(page_miles_totals)

    if len(table) > NUM_ROWS_PAGE_1:
        _write_pdf(form_path, additional_form_path, save_path, values)
    else:
        _write_pdf(form_path, None, save_path, values)
